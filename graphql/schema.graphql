#import Scalars/*.graphql
#import Types/*.graphql
#import Filters/*.graphql
#import Mutations/*.graphql

type Query {
  # General
  "Current user, `null` for guests."
  me: Me

  # Auth
  "Link to perform Sign In, available only for guests."
  authSignIn: String! @guest          # TODO [GraphQL] URL type needed

  # Customers
  "List of all statuses"
  customerStatuses: [Status!]!

  "List of all types"
  customerTypes: [Type!]!

  "List of Customers"
  customers (
    where: CustomersQuery @searchBy
    order: CustomersSort @sortBy
  ): [Customer!]! @guard @paginate

  "Customer with given ID"
  customer (id: ID! @eq): Customer @guard @find

  "List of all customer assets"
  assets(
    where: AssetsQuery @searchBy
    order: AssetsSort @sortBy
  ): [Asset!]! @guard @paginate

  "List of all countries"
  countries: [Country!]! @all @orderBy(column: "code")

  "List of all cities or filter by country id"
  cities(
    where: CitiesQuery @searchBy
  ): [City!]! @all @orderBy(column: "id")

  "List of all location types related to customer"
  locationTypes: [Type!]!

  "List of all contact types"
  contactTypes: [Type!]!

  "Get Locale"
  locale: String!

  "List of all asset types"
  assetTypes: [Type!]!

  "List of all oems"
  oems: [Oem!]! @all

  "Get asset by id"
  asset(id: ID! @eq): Asset @guard @find

  "List of all currencies"
  currencies: [Currency!]! @all @orderBy(column: "code")

  "List of all contracts"
  contracts (
    where: DocumentsQuery @searchBy
    order: DocumentsSort @sortBy
  ): [Document!]! @guard @paginate @builder(method: "App\\GraphQL\\Builders\\ContractsBuilder")

  "Get contract by id"
  contract(id: ID! @eq): Document @guard @find @builder(method: "App\\GraphQL\\Builders\\ContractsBuilder")

  "List of all quotes"
  quotes (
    where: DocumentsQuery @searchBy
    order: DocumentsSort @sortBy
  ): [Document!]! @guard @paginate @builder(method: "App\\GraphQL\\Builders\\QuotesBuilder")

  "Get quote by id"
  quote(id: ID! @eq): Document @guard @find @builder(method: "App\\GraphQL\\Builders\\QuotesBuilder")

  "Get current organization"
  organization: Organization

  "Get app name & version"
  application: Application!

  "List of all contract types"
  contractTypes: [Type!]!

  "List of all quotes types"
  quoteTypes: [Type!]!
}

type Mutation {
  "Return the link where the user should be redirected to complete sign-out."
  authSignOut: String! @guard         # TODO [GraphQL] URL type needed

  "Complete sign-in and returns current User if successful."
  authSignInByCode(code: String!, state: String!): User @guest

  "Password based sing-in."
  authSignInByPassword(
    username: String!               # TODO [GraphQL] Email type needed
    password: String!
  ): User @guest @validator

  "Register new user"
  authSignUp(
    given_name: String!
    family_name: String!
    email: String!                  # TODO [GraphQL] Email type needed
    phone: String!                  # TODO [GraphQL] Phone type needed
    company: String!
    reseller: String
  ): Boolean! @guest @validator

  "Reset password"
  authResetPassword(
    username: String!               # TODO [GraphQL] Email type needed
  ): Boolean! @guest

  "Set Locale"
  locale(
    locale: String! @rules(apply: ["App\\Rules\\Locale"])
  ): Boolean!

  "Set Organization properties"
  organization(
    locale: String
    currency_id: ID
    branding_dark_theme: Boolean
    branding_primary_color: String  # TODO [GraphQL] Color type needed
    branding_secondary_color: String# TODO [GraphQL] Color type needed
    branding_logo: Upload
    branding_favicon: Upload
    website_url: String             # TODO [GraphQL] URL type needed
    email: String                   # TODO [GraphQL] Email type needed
  ): Boolean! @guard @validator

  "Update application settings"
  updateApplicationSettings(input: [UpdateApplicationSettingsInput!]!): UpdateApplicationSettingsPayload @root

  "Update application ui translations"
  updateApplicationStorageTranslations(input: UpdateApplicationStorageTranslationsInput!): UpdateApplicationStorageTranslationsPayload @root

  "Update application api translations"
  updateApplicationTranslations(input: UpdateApplicationTranslationsInput!): UpdateApplicationTranslationsPayload @root
}

input UpdateApplicationSettingsInput @validator {
  name: String!
  value: String!
}

type UpdateApplicationSettingsPayload {
  """
  Updated settings.
  """
  settings: [ApplicationSetting!]!
}

input UpdateApplicationStorageTranslationsInput {
  locale: String! @rules(apply: ["App\\Rules\\Locale"])
  translations: [UpdateApplicationTranslationsTranslation!]!
}

input UpdateApplicationTranslationsTranslation {
  key: String!
  value: String!
  delete: Boolean! = false
}

type UpdateApplicationStorageTranslationsPayload {
  locale: String!
  updated: [Translation!]!
  deleted: [Translation!]!
}

input UpdateApplicationTranslationsInput {
  locale: String! @rules(apply: ["App\\Rules\\Locale"])
  translations: [UpdateApplicationTranslationsTranslation!]!
}

type UpdateApplicationTranslationsPayload {
  locale: String!
  translations: [Translation!]!
}
