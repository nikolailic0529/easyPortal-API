#import Scalars/*.graphql
#import Types/*.graphql
#import Filters/*.graphql
#import Inputs/*.graphql
#import Mutations/**/*.graphql

type Query {
  # General
  "Current user, `null` for guests."
  me: Me

  # Customers
  "List of all statuses"
  customerStatuses: [Status!]!

  "List of all types"
  customerTypes: [Type!]!

  "List of Customers"
  customers (
    where: CustomersQuery @searchBy
    order: CustomersSort @sortBy
  ): [Customer!]! @guard @paginate

  "Customer with given ID"
  customer (id: ID! @eq): Customer @guard @find

  "List of all customer assets"
  assets(
    where: AssetsQuery @searchBy
    order: AssetsSort @sortBy
  ): [Asset!]! @guard @paginate

  "List of all countries"
  countries: [Country!]! @all @orderBy(column: "code")

  "List of all cities or filter by country id"
  cities(
    where: CitiesQuery @searchBy
  ): [City!]! @all @orderBy(column: "id")

  "List of all location types related to customer"
  locationTypes: [Type!]!

  "List of all contact types"
  contactTypes: [Type!]!

  "Get Locale"
  locale: String!

  "List of all asset types"
  assetTypes: [Type!]!

  "List of all oems"
  oems: [Oem!]! @all

  "Get asset by id"
  asset(id: ID! @eq): Asset @guard @find

  "List of all currencies"
  currencies: [Currency!]! @all @orderBy(column: "code")

  "List of all contracts"
  contracts (
    where: DocumentsQuery @searchBy
    order: DocumentsSort @sortBy
  ): [Document!]! @guard @paginate @builder(method: "App\\GraphQL\\Builders\\ContractsBuilder")

  "Get contract by id"
  contract(id: ID! @eq): Document @guard @find @builder(method: "App\\GraphQL\\Builders\\ContractsBuilder")

  "List of all quotes"
  quotes (
    where: DocumentsQuery @searchBy
    order: DocumentsSort @sortBy
  ): [Document!]! @guard @paginate @builder(method: "App\\GraphQL\\Builders\\QuotesBuilder")

  "Get quote by id"
  quote(id: ID! @eq): Document @guard @find @builder(method: "App\\GraphQL\\Builders\\QuotesBuilder")

  "Get current organization"
  organization: Organization

  "Get app name & version"
  application: Application!

  "List of all contract types"
  contractTypes: [Type!]!

  "List of all quotes types"
  quoteTypes: [Type!]!

  "Client data"
  client: Client @field(resolver: "App\\GraphQL\\Resolvers\\EmptyResolver")
}

type Mutation {
  "Return the link where the user should be redirected to complete sign-out."
  authSignOut: String! @guard         # TODO [GraphQL] URL type needed

  "Complete sign-in and returns current User if successful."
  authSignInByCode(code: String!, state: String!): Me @guest

  "Set Locale"
  locale(
    locale: String! @rules(apply: ["App\\Rules\\Locale"])
  ): Boolean!

  "Set Organization properties"
  organization(
    locale: String
    currency_id: ID
    branding_dark_theme: Boolean
    branding_primary_color: String  # TODO [GraphQL] Color type needed
    branding_secondary_color: String# TODO [GraphQL] Color type needed
    branding_logo: Upload
    branding_favicon: Upload
    website_url: String             # TODO [GraphQL] URL type needed
    email: String                   # TODO [GraphQL] Email type needed
  ): Boolean! @guard @validator
}
